%%{init: {'theme':'dark', 'themeVariables': {'primaryBgColor':'#1a1a1a', 'primaryTextColor':'#ffffff', 'primaryBorderColor':'#d2691e', 'lineColor':'#d2691e', 'fontSize':'14px'}}}%%

flowchart TB
    subgraph MasterSchema["ğŸ›ï¸ Master Schema (Stable)"]
        FIBO["FIBO Ontology<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>Financial Industry<br/>Business Ontology"]
        
        MASTER["Master Canonical Schema<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>âœ“ contract (56 fields)<br/>âœ“ customer (20 fields)<br/>âœ“ invoice (23 fields)<br/>âœ“ product (18 fields)<br/>âœ“ sla (14 fields)<br/>âœ“ compliance (12 fields)<br/>âœ“ 15+ entities total<br/><br/>Comprehensive & Stable"]
        
        FIBO -->|"Semantic<br/>Foundation"| MASTER
    end
    
    subgraph ClientMappings["ğŸ—ºï¸ Client-Specific Mappings"]
        MAP_A["Client A Mapping<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>contract.id â†’ contracts.id<br/>contract.customer â†’ contracts.customer_name<br/>contract.total_value â†’ contracts.contract_value<br/>contract.payment_terms â†’ unavailable"]
        
        MAP_B["Client B Mapping<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>contract.id â†’ contract_headers.id<br/>contract.customer â†’ accounts.company_name (join)<br/>contract.total_value â†’ arr Ã— term (calculated)<br/>contract.payment_terms â†’ contract_terms.payment_terms"]
        
        MAP_E["Client E Mapping<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>contract.id â†’ agreements.agreement_id<br/>contract.customer â†’ agreements.client_name<br/>contract.total_value â†’ unavailable<br/>contract.payment_terms â†’ agreements.terms"]
    end
    
    MASTER -->|"Map to<br/>Client A"| MAP_A
    MASTER -->|"Map to<br/>Client B"| MAP_B
    MASTER -->|"Map to<br/>Client E"| MAP_E
    
    MAP_A -->|"Generate SQL"| DB_A["Client A Database"]
    MAP_B -->|"Generate SQL"| DB_B["Client B Database"]
    MAP_E -->|"Generate SQL"| DB_E["Client E Database"]
    
    classDef masterStyle fill:#2d5016,stroke:#4a8b2c,stroke-width:3px,color:#fff
    classDef mappingStyle fill:#1a3a52,stroke:#3a7ca5,stroke-width:2px,color:#fff
    classDef dbStyle fill:#5e2c2c,stroke:#c55a5a,stroke-width:2px,color:#fff
    
    class FIBO,MASTER masterStyle
    class MAP_A,MAP_B,MAP_E mappingStyle
    class DB_A,DB_B,DB_E dbStyle

